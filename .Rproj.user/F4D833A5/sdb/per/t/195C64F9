{
    "contents" : "\n\nlist <- c(\"to\"          \n          ,\"for\"         \n          ,\"and\"         \n          ,\"on\"          \n          ,\"you\"        \n          ,\"this\"        \n          ,\"i\"           \n          ,\"is\"          \n          ,\"in\"                 \n          ,\"be\"          \n          ,\"from\"        \n          ,\"have\"        \n          ,\"we\"          \n          ,\"at\"          \n          ,\"that\"       \n          ,\"deal\"        \n          ,\"will\"        \n          ,\"with\"      \n          ,\"if\"          \n          ,\"please\"      \n          ,\"are\"                  \n          ,\"not\"         \n          ,\"or\"          \n          ,\"as\"         \n          ,\"by\"                         \n          ,\"meter\"       \n          ,\"me\"                  \n          ,\"your\"        \n          ,\"was\"         \n          ,\"can\"         \n          ,\"need\"       \n          ,\"thanks\"     \n          ,\"any\"         \n          ,\"message\"    \n          ,\"may\"         \n          ,\"should\"      \n          ,\"our\"                  \n          ,\"know\"        \n          ,\"original\"   \n          ,\"do\"         \n          ,\"has\"         \n          ,\"all\"                  \n          ,\"been\"        \n          ,\"these\"       \n          ,\"day\"         \n          ,\"they\"        \n          ,\"volume\"     \n          ,\"up\"          \n          ,\"out\"         \n          ,\"there\"      \n          ,\"contract\"    \n          ,\"no\"         \n          ,\"more\"        \n          ,\"here\"        \n          ,\"only\"        \n          ,\"us\"          \n          ,\"information\"\n          ,\"new\"         \n          ,\"company\"     \n          ,\"price\"       \n          ,\"free\"        \n          ,\"get\"        \n          ,\"one\"         \n          ,\"mail\"        \n          ,\"investment\"  \n          ,\"my\"          \n          ,\"but\"                \n          ,\"about\"       \n          ,\"now\"         \n          ,\"which\"                 \n          ,\"its\"         \n          ,\"prices\"      \n          ,\"business\"    \n          ,\"contact\"     \n          ,\"news\"       \n          ,\"over\"        \n          ,\"report\"      \n          ,\"money\"      \n          ,\"stock\"       \n          ,\"their\"       \n          ,\"securities\"  \n          ,\"statements\"  \n          ,\"time\"        \n          ,\"many\"       \n          ,\"reply\"       \n          ,\"looking\")\nframe_name <- c(\"to\"          \n          ,\"for\"         \n          ,\"and\"         \n          ,\"on\"          \n          ,\"you\"        \n          ,\"this\"        \n          ,\"i\"           \n          ,\"is\"          \n          ,\"in\"                 \n          ,\"be\"          \n          ,\"from\"        \n          ,\"have\"        \n          ,\"we\"          \n          ,\"at\"          \n          ,\"that\"       \n          ,\"deal\"        \n          ,\"will\"        \n          ,\"with\"      \n          ,\"if\"          \n          ,\"please\"      \n          ,\"are\"                  \n          ,\"not\"         \n          ,\"or\"          \n          ,\"as\"         \n          ,\"by\"                         \n          ,\"meter\"       \n          ,\"me\"                  \n          ,\"your\"        \n          ,\"was\"         \n          ,\"can\"         \n          ,\"need\"       \n          ,\"thanks\"     \n          ,\"any\"         \n          ,\"message\"    \n          ,\"may\"         \n          ,\"should\"      \n          ,\"our\"                  \n          ,\"know\"        \n          ,\"original\"   \n          ,\"do\"         \n          ,\"has\"         \n          ,\"all\"                  \n          ,\"been\"        \n          ,\"these\"       \n          ,\"day\"         \n          ,\"they\"        \n          ,\"volume\"     \n          ,\"up\"          \n          ,\"out\"         \n          ,\"there\"      \n          ,\"contract\"    \n          ,\"no\"         \n          ,\"more\"        \n          ,\"here\"        \n          ,\"only\"        \n          ,\"us\"          \n          ,\"information\"\n          ,\"new\"         \n          ,\"company\"     \n          ,\"price\"       \n          ,\"free\"        \n          ,\"get\"        \n          ,\"one\"         \n          ,\"mail\"        \n          ,\"investment\"  \n          ,\"my\"          \n          ,\"but\"                \n          ,\"about\"       \n          ,\"now\"         \n          ,\"which\"                 \n          ,\"its\"         \n          ,\"prices\"      \n          ,\"business\"    \n          ,\"contact\"     \n          ,\"news\"       \n          ,\"over\"        \n          ,\"report\"      \n          ,\"money\"      \n          ,\"stock\"       \n          ,\"their\"       \n          ,\"securities\"  \n          ,\"statements\"  \n          ,\"time\"        \n          ,\"many\"       \n          ,\"reply\"       \n          ,\"looking\",\"total_word_count\",\"label\")\n\nham <- function(){\n        setwd(\"C:/Users/sarav rajavelu/Sarav/My Study Material/Coursera/R_sandbox/mini_project/Mini Project/spamset/ham\")\n        dir_list <- dir()\n        len <- length(dir_list)\n        base <- data.frame(matrix(0, ncol = (length(list)+2), nrow = len))\n        names(base) <- frame_name\n        for(i in 1:len){\n                con <- file(dir_list[i],\"r\")\n                file<-readLines(con)\n                file <- paste(file, collapse = \"\")\n                count <- 0\n                while(grepl(\"[[:alnum:]]+\",file,TRUE)){\n                        match <- regexpr(\"[[:alnum:]]+\",file,TRUE)\n                        for (j in seq(list)){\n                                \n                                if(list[j] ==  regmatches(file,match)){\n                                        base[i,j] <- base[i,j] + 1\n                                        break\n                                }\n                        }\n                        count<- count  + 1\n                        file <- sub(\"[[:alnum:]]+\",\"\",file)\n                }\n                for(j in seq(list)){\n                        base[i,j] <- (base[i,j]/count)*100\n                }\n                base[i,87] <- count\n                base[i,88] <- \"Ham\"\n                close(con)\n                print(base[i,])\n        }\n        write.csv(base, file = \"ham.csv\")\n}\n        \n                \nspam <- function(){\n        setwd(\"C:/Users/sarav rajavelu/Sarav/My Study Material/Coursera/R_sandbox/mini_project/Mini Project/spamset/spam\")\n        dir_list <- dir()\n        len <- length(dir_list)\n        base <- data.frame(matrix(0, ncol = (length(list)+2), nrow = len))\n        names(base) <- frame_name\n        for(i in 1:len){\n                con <- file(dir_list[i],\"r\")\n                file<-readLines(con)\n                file <- paste(file, collapse = \"\")\n                count <- 0\n                while(grepl(\"[[:alnum:]]+\",file,TRUE)){\n                        match <- regexpr(\"[[:alnum:]]+\",file,TRUE)\n                        for (j in seq(list)){\n                                \n                                if(list[j] ==  regmatches(file,match)){\n                                        base[i,j] <- base[i,j] + 1\n                                        break\n                                }\n                        }\n                        count<- count  + 1\n                        file <- sub(\"[[:alnum:]]+\",\"\",file)\n                }\n                for(j in seq(list)){\n                        base[i,j] <- (base[i,j]/count)*100\n                }\n                base[i,87] <- count\n                base[i,88] <- \"Spam\"\n                close(con)\n                print(base[i,])\n        }\n        write.csv(base, file = \"spam.csv\")\n}\n\npredict_mail  <- function(){\n        library(caret)\n        library(nnet)\n        library(ggplot2)\n        library(lattice)\n        mailset <- read.csv('mailset.csv')\n        set.seed(nrow(mailset))\n        mailset <- mailset[sample(nrow(mailset)),]\n        split <- floor(nrow(mailset)/2)\n        mailTrain <- mailset[0:split,]\n        mailTest <- mailset[(split+1):nrow(mailset),]\n        \n        cylModel <- multinom(label~., data = mailTrain, maxit=100, trace=T)\n        \n        mostImportantVariables <- varImp(cylModel)\n        mostImportantVariables$Variables <- row.names(mostImportantVariables)\n        mostImportantVariables <- mostImportantVariables[order(-mostImportantVariables$Overall),]\n        print(head(mostImportantVariables))\n        preds1 <- predict(cylModel, type=\"probs\", newdata=mailTest)\n        preds2 <- predict(cylModel, type=\"class\", newdata=mailTest)\n        print(postResample(mailTest$label,preds2))\n        \n   \n        head(preds2)\n        head(preds1)\n}\n\nplot_mail_nnet <- function(){\nlibrary(nnet)\nlibrary(RCurl)\nlibrary(scales)\nlibrary(reshape)\nlibrary(bitops)\nmailset <- read.csv('mailset.csv')\nset.seed(nrow(mailset))\nmailset <- mailset[sample(nrow(mailset)),]\nla <- mailset[,90]\nl <- numeric()\nfor(i in 1:length(la)){if(la[i] == 'Spam')l[i] <- 1 else l[i] <- 0}\nmod1 <- nnet(mailset[,3:89],l,size=10,linout = T)\nrequire(RCurl)\n\n#root.url<-'https://gist.github.com/fawda123'\n#raw.fun<-paste(\n#        root.url,\n#        '5086859/raw/17fd6d2adec4dbcf5ce750cbd1f3e0f4be9d8b19/nnet_plot_fun.r',\n#        sep='/'\n#)\n#script<-getURL(raw.fun, ssl.verifypeer = FALSE)\n#eval(parse(text = script))\n#rm('script','raw.fun')\npar(mar=numeric(4),mfrow=c(1,2),family='serif')\nplot(mod1,nid=F)\nplot(mod1)\n}",
    "created" : 1415819938415.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2198257482",
    "id" : "195C64F9",
    "lastKnownWriteTime" : 1415635873,
    "path" : "C:/Users/sarav rajavelu/Sarav/My Study Material/Coursera/R_sandbox/mini_project/Mini Project/functions.R",
    "project_path" : "functions.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}